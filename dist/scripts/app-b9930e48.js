"use strict";angular.module("appMaze",["ngAnimate","ngTouch","ngSanitize","ui.router","ngMaterial"]).config(["$stateProvider","$urlRouterProvider",function(e,t){e.state("home",{url:"/",templateUrl:"app/main/main.html",controller:"MainCtrl"}).state("game",{url:"/game",templateUrl:"app/game/game.html",controller:"gameController"}).state("build",{url:"/build",templateUrl:"app/build/build.html",controller:"buildController"}),t.otherwise("/")}]),angular.module("appMaze").controller("NavbarCtrl",["$scope",function(e){e.date=new Date}]),angular.module("appMaze").controller("MainCtrl",["$scope",function(){}]),angular.module("appMaze").controller("gameController",["$scope","mazes","builds",function(e,t,n){angular.extend(e,t),angular.extend(e,n),e.func=function(t){e.choice="",e.n=t,e.map=e.newMaze(t,t),e.mapTranslated=e.translate(e.map),e.maze2=e.mapTranslated,console.log("this working",t),console.log(e.map),console.log(e.mapTranslated),e.go()},e.go=function(){console.log("i am going"),t.maze=e.maze2,t.n=e.n,t.threeHelper()}}]).factory("mazes",["$http",function(){var e={};e.n=4;var t=0;return e.score=t,e.maze=[[15,1,1,3],[8,8,0,2],[8,8,0,2],[12,4,4,6]],e.timer=new Stopwatch,e.threeHelper=function(){function n(){void 0===e.maze&&(e.n=8,e.maze=[[9,1,1,1,3,1,1,3],[8,4,4,4,12,3,0,2],[8,0,0,0,0,2,0,2],[8,0,0,9,1,2,0,2],[9,0,0,8,0,2,0,2],[10,0,15,0,0,0,0,2],[10,0,2,0,0,0,0,2],[12,4,6,4,4,4,4,6]]);var t=new x.Mesh(new x.BoxGeometry(2*e.n*f+f,10,2*e.n*f+f),new x.MeshLambertMaterial({color:15584160}));t.position.x=.5*f*e.n,t.position.z=.5*f*e.n,l.add(t);for(var n=0;n<e.n;n++)for(var o=0;o<e.n;o++){var a,r=new x.BoxGeometry(f,w,v),i=new x.BoxGeometry(f,w,v),d=new x.BoxGeometry(v,w,f),s=new x.BoxGeometry(v,w,f),c=new x.MeshLambertMaterial({color:16711680}),u=new x.Mesh(r,c),p=new x.Mesh(i,c),m=new x.Mesh(d,c),h=new x.Mesh(s,c),g=e.maze[n][o];a=1&g,console.log("top: ",a),1===a&&(u.position.x=o*f,u.position.y=w/2,u.position.z=n*f-b,M.push(u),l.add(u),console.log("cell ",n,o,"has a top wall")),a=2&g,console.log("right: ",a),2===a&&(m.position.x=o*f-b+f,m.position.y=w/2,m.position.z=n*f,M.push(m),l.add(m),console.log("cell ",n,o,"has a right wall")),a=4&g,console.log("bottom: ",a),4===a&&(p.position.x=o*f,p.position.y=w/2,p.position.z=n*f-b+f,M.push(p),l.add(p),console.log("cell ",n,o,"has a bottom wall")),a=8&g,console.log("left: ",a),8===a&&(h.position.x=o*f-b,h.position.y=w/2,h.position.z=n*f,M.push(h),l.add(h),console.log("cell ",n,o,"has a right wall"))}var y=30,z=new THREE.SphereGeometry(y,16,8),k=new THREE.MeshLambertMaterial({color:16766720}),E=new THREE.Mesh(z,k);E.position.x=Math.floor(Math.random()*e.n*f),E.position.z=Math.floor(Math.random()*e.n*f),E.position.y=50,l.add(E);var C=new x.DirectionalLight(16248766,.7);C.position.set(.5,1,.5),l.add(C);var j=new x.DirectionalLight(16248766,.7);j.position.set(-.5,-1,-.5),l.add(j)}function o(){z&&requestAnimationFrame(o),a()}function a(){t=e.timer.update(),e.score=t,r(),i(),c.clear(),y?c.render(l,d):c.render(l,s)}function r(){var e=p.getDelta(),t=200*e,n=Math.PI/2*e;(u.pressed("W")||u.pressed("up"))&&(i()||d.translateZ(-t)),(u.pressed("S")||u.pressed("down"))&&(i()||d.translateZ(t)),(u.pressed("A")||u.pressed("left"))&&d.rotateOnAxis(new THREE.Vector3(0,1,0),n),(u.pressed("D")||u.pressed("right"))&&d.rotateOnAxis(new THREE.Vector3(0,1,0),-n),u.pressed("1")&&(y=!0),u.pressed("2")&&(y=!1)}function i(){var e=new THREE.Vector3(0,0,-1);e.applyQuaternion(d.quaternion);var t=new THREE.Raycaster(d.position,e),n=t.intersectObjects(l.children,!0);return n.length>0&&n[0].distance<5?(console.log("collision",n[0]),!0):void 0}var l,d,s,c,u,p,m=window.innerWidth,h=window.innerHeight,g=m/h,f=240,v=20,b=f/2-v/2,w=f/3,x=THREE,y=!0,M=[],z=!0,k=function(){e.timer.start(),p=new x.Clock,l=new x.Scene,l.fog=new x.FogExp2(14086655,5e-4),u=new THREEx.KeyboardState,d=new x.PerspectiveCamera(60,g,1,1e4),d.position.y=.2*f,d.position.x=f/4,d.position.z=f*(e.n-1)+f/2,l.add(d),s=new THREE.OrthographicCamera(-2*window.innerWidth,2*window.innerWidth,2*window.innerHeight,-2*window.innerHeight,-5e3,1e4),s.up=new THREE.Vector3(0,0,-1),s.lookAt(new THREE.Vector3(0,-1,0)),s.position.x=f*(e.n/2+1),s.position.z=f*(e.n/2+1),l.add(s),n(),c=new x.WebGLRenderer,c.setSize(m,h),c.autoClear=!1,c.domElement.style.backgroundColor=13434879,document.body.appendChild(c.domElement)};k(),o()},e}]),angular.module("appMaze").controller("buildController",["$scope","builds",function(e,t){angular.extend(e,t),e.n=0,e.func=function(t){e.choice="",e.n=t,e.map=e.newMaze(t,t),e.mapTranslated=e.translate(e.map),console.log("this working",t),console.log(e.map),console.log(e.mapTranslated)}}]).factory("builds",["$http",function(){var e={};return e.mapIt=function(e){for(var t=[],n=[],o=0;e>o;o++)t.push(0);for(var a=0;e>a;a++)n.push(t.slice(0));return n},e.translate=function(e){for(var t=[],n=0;n<e.length;n++){for(var o=[],a=0;a<e.length;a++){var r=0,i=e[n][a];r=1*i[0]+2*i[1]+4*i[2]+8*i[3],o.push(r)}t.push(o)}return t},e.newMaze=function(e,t){for(var n=e*t,o=new Array,a=new Array,r=0;t>r;r++){o[r]=new Array,a[r]=new Array;for(var i=0;e>i;i++)o[r][i]=[0,0,0,0],a[r][i]=!0}var l=[Math.floor(Math.random()*t),Math.floor(Math.random()*e)],d=[l];a[l[0]][l[1]]=!1;for(var s=1;n>s;){for(var c=[[l[0]-1,l[1],0,2],[l[0],l[1]+1,1,3],[l[0]+1,l[1],2,0],[l[0],l[1]-1,3,1]],u=new Array,p=0;4>p;p++)c[p][0]>-1&&c[p][0]<t&&c[p][1]>-1&&c[p][1]<e&&a[c[p][0]][c[p][1]]&&u.push(c[p]);if(u.length){var m=u[Math.floor(Math.random()*u.length)];o[l[0]][l[1]][m[2]]=1,o[m[0]][m[1]][m[3]]=1,a[m[0]][m[1]]=!1,s++,l=[m[0],m[1]],d.push(l)}else l=d.pop()}return o},e}]),angular.module("201412Solo").run(["$templateCache",function(e){e.put("app/build/build.html",'<div layout="vertical" layout-fill="" ng-controller="buildController"><header ng-include="\'components/navbar/navbar.html\'"></header><div class="buildArea"><input ng-model="choice" placeholder="enter a number"> <button ng-click="func(choice)">Submit</button> {{choice}}</div></div>'),e.put("app/build/gen.html","<html><head><title>Maze maker</title><style type=\"text/css\">\ntable { border-collapse: collapse }\ntd { width: 1em; height: 1em; border: 1px solid }\ntd.s { border-bottom: none }\ntd.n { border-top: none }\ntd.w { border-left: none }\ntd.e { border-right: none }\ntd.v { background: skyblue}\n</style><script type=\"application/javascript\">Node.prototype.add = function(tag, cnt, txt) { for (var i = 0; i < cnt; i++) this.appendChild(ce(tag, txt)); } Node.prototype.ins = function(tag) { this.insertBefore(ce(tag), this.firstChild) } Node.prototype.kid = function(i) { return this.childNodes[i] } Node.prototype.cls = function(t) { this.className += ' ' + t } NodeList.prototype.map = function(g) { for (var i = 0; i < this.length; i++) g(this[i]); } function ce(tag, txt) { var x = document.createElement(tag); if (txt !== undefined) x.innerHTML = txt; return x } function gid(e) { return document.getElementById(e) } function irand(x) { return Math.floor(Math.random() * x) } function make_maze() { var w = parseInt(gid('rows').value || 8, 10); var h = parseInt(gid('cols').value || 8, 10); var tbl = gid('maze'); tbl.innerHTML = ''; tbl.add('tr', h); tbl.childNodes.map(function(x) { x.add('th', 1); x.add('td', w, '*'); x.add('th', 1)}); tbl.ins('tr'); tbl.add('tr', 1); tbl.firstChild.add('th', w + 2); tbl.lastChild.add('th', w + 2); for (var i = 1; i <= h; i++) { for (var j = 1; j <= w; j++) { tbl.kid(i).kid(j).neighbors = [ tbl.kid(i + 1).kid(j), tbl.kid(i).kid(j + 1), tbl.kid(i).kid(j - 1), tbl.kid(i - 1).kid(j) ]; } } walk(tbl.kid(irand(h) + 1).kid(irand(w) + 1)); gid('solve').style.display='inline'; } function shuffle(x) { for (var i = 3; i > 0; i--) { j = irand(i + 1); if (j == i) continue; var t = x[j]; x[j] = x[i]; x[i] = t; } return x; } var dirs = ['s', 'e', 'w', 'n']; function walk(c) { c.innerHTML = '&nbsp;'; var idx = shuffle([0, 1, 2, 3]); for (var j = 0; j < 4; j++) { var i = idx[j]; var x = c.neighbors[i]; if (x.textContent != '*') continue; c.cls(dirs[i]), x.cls(dirs[3 - i]); walk(x); } } function solve(c, t) { if (c === undefined) { c = gid('maze').kid(1).kid(1); c.cls('v'); } if (t === undefined) t = gid('maze') .lastChild.previousSibling .lastChild.previousSibling; if (c === t) return 1; c.vis = 1; for (var i = 0; i < 4; i++) { var x = c.neighbors[i]; if (x.tagName.toLowerCase() == 'th') continue; if (x.vis || !c.className.match(dirs[i]) || !solve(x, t)) continue; x.cls('v'); return 1; } c.vis = null; return 0; }</script></head><body><form><fieldset><label>rows</label><input id=\"rows\" size=\"3\"> <label>colums</label><input id=\"cols\" size=\"3\"> <a href=\"javascript:make_maze()\">Generate</a> <a id=\"solve\" style=\"display:none\" href=\"javascript:solve(); void(0)\">Solve</a></fieldset></form><table id=\"maze\"></table></body></html>"),e.put("app/game/game.html",'<div layout="vertical" layout-fill="" ng-controller="gameController"><header ng-include="\'components/navbar/navbar.html\'"></header><div class="gameArea"><span ng-click="go()">Click to start</span> <input ng-model="choice" placeholder="enter a number"> <button ng-click="func(choice)">Generate a maze</button></div></div>'),e.put("app/main/main.html",'<div layout="vertical" layout-fill=""><header ng-include="\'components/navbar/navbar.html\'"></header><md-content><section class="jumbotron"><h1>3D Maze Game!</h1></section><div class="techs" layout-align="center"><div ui-view="game"></div></div></md-content><footer><md-toolbar layout="row" layout-align="center center"></md-toolbar></footer></div>'),e.put("components/navbar/navbar.html",'<md-toolbar layout="row" layout-align="center center" ng-controller="NavbarCtrl"><section flex="" layout="row" layout-align="left center"><md-button href="#" class="md-raised">Home</md-button><md-button href="#/game" class="md-raised">Play</md-button><md-button href="#/build" class="md-raised">Build a maze</md-button></section></md-toolbar>')}]);